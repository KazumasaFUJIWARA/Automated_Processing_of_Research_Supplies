# CSVおよびJSONデータをExcelに統合するプロジェクト

このプロジェクトは、CSVファイルとJSONファイルからデータを抽出し、既存のExcelファイルに統合するPythonスクリプトを提供します。Excelファイル内のチェックボックスなどのオブジェクトも保持されるよう設計されています。

## 特徴
- JSONファイルから商品の情報（品名と価格）を抽出。
- CSVファイルから申請者や研究代表者の情報を読み取り。
- データをExcelの指定されたセルに書き込み。
- `pywin32`ライブラリを使用して、Excelファイル内のチェックボックスを保持。

## 必要な環境
以下の環境が必要です：

1. Pythonがインストールされていること。
2. 必要なPythonライブラリのインストール：
   ```bash
   pip install pywin32
   ```
3. Microsoft Excelがインストールされていること。
4. プロジェクトディレクトリに以下のファイルが存在すること：
   - `Kaken.xlsx`：編集対象のExcelファイル。
   - `test.json`：商品の詳細が含まれるJSONファイル。
   - `Fujiwara_Kansetsu.csv`：申請者や研究代表者の情報が含まれるCSVファイル。

## ファイルの詳細

### JSONファイル (`test.json`)
商品の情報を格納しています。例：
```json
{
  "items": [
    {
      "product_name": "USBポート付延長コード",
      "price": "3780"
    },
    {
      "product_name": "LANケーブル",
      "price": "2940"
    }
  ]
}
```

### CSVファイル (`Fujiwara_Kansetsu.csv`)
タブ区切り形式で申請者や研究代表者の情報を記載しています。例：
```
申請者	藤原和将
研究代表者	藤原和将
```

### Excelファイル (`Kaken.xlsx`)
編集対象のExcelファイル。チェックボックスやその他のオブジェクトを含む場合でも、それらを保持します。

## 使用方法

1. リポジトリをクローンします。
2. 必要なファイルをプロジェクトディレクトリに配置します。
3. 以下のコマンドでスクリプトを実行します：
   ```bash
   python test_csv_json_win32.py
   ```
4. 更新されたExcelファイルが`output.xlsx`として保存されます。

## 処理内容

1. **JSONの処理**：
   - JSONファイルから品名と価格を抽出。
   - 価格が`0`のアイテムは除外。
   - 抽出したデータをExcelの`G28`列（品名）および`V28`列（価格）以降に書き込み。

2. **CSVの処理**：
   - CSVファイルから申請者や研究代表者の情報を読み取り。
   - 指定されたセル（例：`Q10`や`Q11`）に書き込み。

3. **Excel統合**：
   - `pywin32`ライブラリを使用してExcelを操作。
   - Excel内のチェックボックスやオブジェクトを保持。

## 出力結果
- JSONデータが`G28`および`V28`以降に記載されます。
- CSVデータが指定のセル（例：`Q10`や`Q11`）に記載されます。
- 編集後のExcelファイルは`output.xlsx`として保存されます。

## トラブルシューティング

- **ファイルが見つからないエラー**:
  指定したパスが正しいことを確認してください。

- **権限エラー**:
  保存先のフォルダーに書き込み権限があることを確認してください。

- **ライブラリが不足している場合**:
  必要なライブラリをインストールしてください：
  ```bash
  pip install pywin32
  ```

## ライセンス
このプロジェクトはMITライセンスの下で公開されています。


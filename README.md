# 科研費自動化プロジェクト

## 概要
領収書をOCRして, 科研用の処理を自動化するシステム
科研の処理は, 物品購入以外にも出張資料や, 業務委託などもありますが,
まずは物品購入処理の自動化をここで目指します.

1. 領収書からの項目と金額, 日時並びに利用者の読み込み
1. 利用者の記載がない場合は, 別途入力させた上で, 利用する科研費の選択
1. 項目ごとに, メーカー, 品名, 型番, 金額, 個数を読み込む
1. 品名, メーカー, 型番, 金額, 想定費目をUIに表示させる.
1. ユーザーが上記のUIを確認し, 追加入力+訂正

## load map
+ localでデモのjsonファイルから,
処理に必要なjsonファイルを作成する.
+ 上記に合致したUIを作る.
+ OCRのapiと接続する
+ ローカルにおくDBなどをサーバーサイドへ移行
+ 科研の新システムが公開され次第,
出力をそちらに対応させる

## OCR関連
OCRは現在 Gemini Flash Latestを利用しています.
Promptは以下

+ 単価はGeminiが判断できました

```
領収書か納品書の情報を解析し、購入項目ごとに以下の形式でJSONに構造化してください.
ただし、以下の処理を施してください.
+ 金額の部分はカンマがあれば覗いてください
+ 金額が0の項目は無視してください 

{
  "title": "領収書タイトル",
  "issuer": "発行者情報",
  "receiver_group": "受領者所属",
  "receiver_group": "受領者氏名(敬称、空白は除く)",
  "total_amount": "合計金額",
  "payment_date": "支払日",
  "items": [
    {
      "product_name": "製品名(型番は抜く) ",
      "provider": "メーカー",
      "model": "型番"
      "unite_price": "単価",
      "total_price": "金額"
      "number": "個数",
      "delivery_date": "発送日"
    },
    ...
  ]
}
```

## Discussion
+ UIとしては, teamsの業務アプリに候補が入力された状態が楽かなと感じています.

+ UIに処理上のエラーがある場合は, ダイアログメッセージを出したいです.

+ UIに提出できない状況である場合は, 警告をだしたいです.

+ 税の判別までは現在ＯＣＲしきれないので,
合計金額と項目毎の読み取り金額の合計がずれていた場合は,
各項目の金額に税を追加してはどうでしょうか.

+ 分担の場合は, 代表者の表示もした方がよい気がしますが,
分担でない場合は, いちいち表示させたくないと感じています.
UIの設計にいいアイディアはありますか?
